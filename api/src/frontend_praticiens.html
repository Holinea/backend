
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Liste des praticiens – React demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <style>
    :root {
      --bleu:#01014B; --texte:#2F3239; --cta:#79C2A0; --accent:#F66F57; --bg:#FBDBC4;
    }
    body { font-family: Montserrat, Arial, sans-serif; margin:0; background:linear-gradient(110deg,#F5F0E7 50%,var(--bg) 100%); color:var(--texte);}
    header{padding:22px 16px; text-align:center; background:#fff7f0; box-shadow:0 2px 14px #ffd0b326;}
    h1{margin:0; color:var(--bleu);}
    .wrap{max-width:1100px; margin:22px auto; padding:0 16px;}
    .grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:18px;}
    .card{background:#fff; border-radius:18px; padding:18px; box-shadow:0 8px 28px #01014b15;}
    .name{color:var(--bleu); font-weight:800; letter-spacing:.02em;}
    .spec{background:#eafaf1; color:#21544c; padding:4px 10px; border-radius:12px; display:inline-block; margin:6px 0;}
    .addr{font-size:.95em; color:#395441;}
    .note{color:#FFC21A; font-weight:700; margin-top:6px;}
    .price{color:var(--accent); font-weight:800; margin-top:8px;}
    .avatar{width:64px; height:64px; border-radius:50%; object-fit:cover; border:3px solid #FFD0B3; box-shadow:0 2px 10px #00000010;}
    .top{display:flex; align-items:center; gap:12px; margin-bottom:8px;}
    .err{background:#ffe8e8; color:#9a1b1b; padding:12px 14px; border-radius:10px;}
    .loader{opacity:.7; font-weight:700; display:flex; align-items:center; gap:10px;}
    .loader i{animation:spin 1s linear infinite;}
    @keyframes spin{to{transform:rotate(360deg)}}
    .toolbar{display:flex; gap:10px; margin: 12px 0 18px; flex-wrap:wrap;}
    .search{flex:1; min-width:220px; border:1.5px solid var(--cta); border-radius:12px; padding:10px 12px;}
    .btn{background:linear-gradient(90deg,var(--cta),#FFD0B3); color:#fff; border:none; padding:10px 16px; border-radius:12px; font-weight:700; cursor:pointer;}
  </style>
</head>
<body>
  <header><h1>Praticiens</h1></header>
  <div id="app" class="wrap"></div>

  <!-- React CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <script type="text/javascript">
    const { useEffect, useState, useMemo } = React;

    function App(){
      const [data, setData] = useState([]);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState('');
      const [q, setQ] = useState('');

      const API_URL = 'http://localhost:8888/R301/Holinea_MVC/api/public/praticiens';

      useEffect(() => {
        (async () => {
          try {
            const res = await fetch(API_URL, { headers: { 'Accept':'application/json' }});
            if(!res.ok) throw new Error('HTTP ' + res.status);
            const json = await res.json();
            setData(json);
          } catch (e) {
            setError("Impossible de charger la liste ("+e.message+").");
          } finally {
            setLoading(false);
          }
        })();
      }, []);

      const filtered = useMemo(() => {
        if(!q.trim()) return data;
        const t = q.toLowerCase();
        return data.filter(p =>
          (p.nom||'').toLowerCase().includes(t) ||
          (p.prenom||'').toLowerCase().includes(t) ||
          (p.specialites||'').toLowerCase().includes(t) ||
          (p.adresse_cabinet||'').toLowerCase().includes(t)
        );
      }, [q, data]);

      if(loading) return <div className="loader"><i className="fa fa-circle-notch"></i> Chargement…</div>;
      if(error)   return <div className="err">{error}</div>;

      return (
        <>
          <div className="toolbar">
            <input className="search" placeholder="Rechercher (nom, spécialité, ville…)" value={q} onChange={e=>setQ(e.target.value)} />
            <button className="btn" onClick={()=>setQ('')}>Réinitialiser</button>
          </div>
          <div className="grid">
            {filtered.map(p => (
              <div key={p.id_praticien} className="card">
                <div className="top">
                  <img className="avatar" src={p.photo_profil_url || 'https://via.placeholder.com/64'} alt="" />
                  <div>
                    <div className="name">{p.prenom} {p.nom}</div>
                    <div className="spec">{p.specialites || '—'}</div>
                  </div>
                </div>
                <div className="addr"><i className="fa fa-map-marker-alt"></i> {p.adresse_cabinet || '—'}</div>
                <div className="note"><i className="fa fa-star"></i> {Number(p.note||0).toFixed(1)} / 5</div>
                {p.tarifs_consultation ? <div className="price">À partir de {p.tarifs_consultation} €</div> : null}
              </div>
            ))}
          </div>
        </>
      );
    }

    ReactDOM.createRoot(document.getElementById('app')).render(React.createElement(App));
  </script>
</body>
</html>
